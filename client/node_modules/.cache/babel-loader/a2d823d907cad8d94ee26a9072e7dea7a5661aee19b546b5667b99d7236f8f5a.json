{"ast":null,"code":"var _jsxFileName = \"/Users/mauriciolopez/Cargapp/client/src/ConnectorStatsCard.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\n\n// --- INICIO: CACHÉ Y CONTROL DE PETICIONES ---\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst statsCache = {};\nconst inFlightRequests = {};\nfunction fetchStatsWithCache(connectorId) {\n  // Si ya está en caché, devolver una promesa resuelta\n  if (statsCache[connectorId]) {\n    return Promise.resolve(statsCache[connectorId]);\n  }\n  // Si ya hay una petición en curso, devolver la promesa existente\n  if (inFlightRequests[connectorId]) {\n    return inFlightRequests[connectorId];\n  }\n  // Si no, lanzar el fetch y guardar la promesa\n  const promise = fetch(`${process.env.REACT_APP_API_URL}/api/sessions/stats?connector_id=${encodeURIComponent(connectorId)}`).then(res => res.json()).then(data => {\n    var _data$total_sessions, _data$total_minutes;\n    statsCache[connectorId] = {\n      total_sessions: (_data$total_sessions = data.total_sessions) !== null && _data$total_sessions !== void 0 ? _data$total_sessions : '-',\n      total_minutes: (_data$total_minutes = data.total_minutes) !== null && _data$total_minutes !== void 0 ? _data$total_minutes : '-'\n    };\n    delete inFlightRequests[connectorId];\n    return statsCache[connectorId];\n  }).catch(() => {\n    delete inFlightRequests[connectorId];\n    return {\n      total_sessions: '-',\n      total_minutes: '-'\n    };\n  });\n  inFlightRequests[connectorId] = promise;\n  return promise;\n}\n// --- FIN: CACHÉ Y CONTROL DE PETICIONES ---\n\nexport default function ConnectorStatsCard({\n  connector\n}) {\n  _s();\n  const [stats, setStats] = useState({\n    total_sessions: '-',\n    total_minutes: '-'\n  });\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    if (!(connector !== null && connector !== void 0 && connector.connectorId)) return;\n    setLoading(true);\n    fetchStatsWithCache(connector.connectorId).then(result => {\n      setStats(result);\n      setLoading(false);\n    });\n  }, [connector === null || connector === void 0 ? void 0 : connector.connectorId]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `rounded-lg border shadow p-4 flex flex-col gap-1 ${connector.status === 'Charging' ? 'border-orange-500 bg-orange-50' : connector.status === 'Available' ? 'border-green-500 bg-green-50' : 'border-gray-400 bg-gray-100'}`,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-2 mb-1\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"font-semibold text-gray-800\",\n        children: \"Conector:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-gray-700\",\n        children: connector.connectorId\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"font-semibold text-gray-800\",\n        children: \"Estado:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: `font-bold ${connector.status === 'Charging' ? 'text-orange-600' : connector.status === 'Available' ? 'text-green-600' : 'text-gray-500'}`,\n        children: connector.status\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-sm text-orange-700\",\n        children: \"Minutos:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-sm font-semibold\",\n        children: loading ? /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"animate-pulse\",\n          children: \"...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 60\n        }, this) : stats.total_minutes\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-sm text-orange-700\",\n        children: \"Sesiones:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-sm font-semibold\",\n        children: loading ? /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"animate-pulse\",\n          children: \"...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 60\n        }, this) : stats.total_sessions\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-xs text-gray-400\",\n        children: \"Tipo:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-xs text-gray-600\",\n        children: connector.type\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center gap-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-xs text-gray-400\",\n        children: \"Potencia:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-xs text-gray-600\",\n        children: [connector.power, \" kW\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 5\n  }, this);\n}\n_s(ConnectorStatsCard, \"eGmbt4NdaHy5w5eQnBJI4XtZ2+g=\");\n_c = ConnectorStatsCard;\nvar _c;\n$RefreshReg$(_c, \"ConnectorStatsCard\");","map":{"version":3,"names":["React","useEffect","useState","jsxDEV","_jsxDEV","statsCache","inFlightRequests","fetchStatsWithCache","connectorId","Promise","resolve","promise","fetch","process","env","REACT_APP_API_URL","encodeURIComponent","then","res","json","data","_data$total_sessions","_data$total_minutes","total_sessions","total_minutes","catch","ConnectorStatsCard","connector","_s","stats","setStats","loading","setLoading","result","className","status","children","fileName","_jsxFileName","lineNumber","columnNumber","type","power","_c","$RefreshReg$"],"sources":["/Users/mauriciolopez/Cargapp/client/src/ConnectorStatsCard.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\n\n// --- INICIO: CACHÉ Y CONTROL DE PETICIONES ---\nconst statsCache = {};\nconst inFlightRequests = {};\n\nfunction fetchStatsWithCache(connectorId) {\n  // Si ya está en caché, devolver una promesa resuelta\n  if (statsCache[connectorId]) {\n    return Promise.resolve(statsCache[connectorId]);\n  }\n  // Si ya hay una petición en curso, devolver la promesa existente\n  if (inFlightRequests[connectorId]) {\n    return inFlightRequests[connectorId];\n  }\n  // Si no, lanzar el fetch y guardar la promesa\n  const promise = fetch(`${process.env.REACT_APP_API_URL}/api/sessions/stats?connector_id=${encodeURIComponent(connectorId)}`)\n    .then(res => res.json())\n    .then(data => {\n      statsCache[connectorId] = {\n        total_sessions: data.total_sessions ?? '-',\n        total_minutes: data.total_minutes ?? '-'\n      };\n      delete inFlightRequests[connectorId];\n      return statsCache[connectorId];\n    })\n    .catch(() => {\n      delete inFlightRequests[connectorId];\n      return { total_sessions: '-', total_minutes: '-' };\n    });\n  inFlightRequests[connectorId] = promise;\n  return promise;\n}\n// --- FIN: CACHÉ Y CONTROL DE PETICIONES ---\n\nexport default function ConnectorStatsCard({ connector }) {\n  const [stats, setStats] = useState({ total_sessions: '-', total_minutes: '-' });\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (!connector?.connectorId) return;\n    setLoading(true);\n    fetchStatsWithCache(connector.connectorId)\n      .then(result => {\n        setStats(result);\n        setLoading(false);\n      });\n  }, [connector?.connectorId]);\n\n  return (\n    <div\n      className={`rounded-lg border shadow p-4 flex flex-col gap-1 ${connector.status === 'Charging' ? 'border-orange-500 bg-orange-50' : connector.status === 'Available' ? 'border-green-500 bg-green-50' : 'border-gray-400 bg-gray-100'}`}\n    >\n      <div className=\"flex items-center gap-2 mb-1\">\n        <span className=\"font-semibold text-gray-800\">Conector:</span>\n        <span className=\"text-gray-700\">{connector.connectorId}</span>\n      </div>\n      <div className=\"flex items-center gap-2\">\n        <span className=\"font-semibold text-gray-800\">Estado:</span>\n        <span className={`font-bold ${connector.status === 'Charging' ? 'text-orange-600' : connector.status === 'Available' ? 'text-green-600' : 'text-gray-500'}`}>{connector.status}</span>\n      </div>\n      <div className=\"flex items-center gap-2\">\n        <span className=\"text-sm text-orange-700\">Minutos:</span>\n        <span className=\"text-sm font-semibold\">{loading ? <span className=\"animate-pulse\">...</span> : stats.total_minutes}</span>\n      </div>\n      <div className=\"flex items-center gap-2\">\n        <span className=\"text-sm text-orange-700\">Sesiones:</span>\n        <span className=\"text-sm font-semibold\">{loading ? <span className=\"animate-pulse\">...</span> : stats.total_sessions}</span>\n      </div>\n      <div className=\"flex items-center gap-2\">\n        <span className=\"text-xs text-gray-400\">Tipo:</span>\n        <span className=\"text-xs text-gray-600\">{connector.type}</span>\n      </div>\n      <div className=\"flex items-center gap-2\">\n        <span className=\"text-xs text-gray-400\">Potencia:</span>\n        <span className=\"text-xs text-gray-600\">{connector.power} kW</span>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}